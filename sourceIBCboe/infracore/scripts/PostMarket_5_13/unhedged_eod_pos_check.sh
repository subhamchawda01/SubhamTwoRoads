dt=$1;
(echo "FUT Positions:" ; for prod in `cat /NAS1/data/MFGlobalTrades/ind_pnls/FO/eod_pnls/ind_pnl_${dt}.txt | grep FUT | awk '{print $2;}' | cut -d'_' -f1 | sort | uniq` ; do lot=`cat /spare/local/tradeinfo/NSE_Files/Lotsizes/fo_mktlots_${dt}.csv | awk -v prod=${prod} -F ',' '{gsub(/[ \t]+$/, "", $2); if($2 == prod) {print $3;}}'` ; grep " ${prod}_FUT" /NAS1/data/MFGlobalTrades/ind_pnls/FO/eod_pnls/ind_pnl_${dt}.txt | sort | awk -v prod="$prod" '{pos += $(NF-6)} END {if(pos != 0) {printf "%s %d ",prod,pos;}}'; echo $lot ; done | awk '{if (NF > 1) {print $1,$2,$2/$3;}}' | sort -nrk3 ; echo "" ; echo "OPT Positions:" ; egrep "C0|P0"  /NAS1/data/MFGlobalTrades/ind_pnls/FO/eod_pnls/ind_pnl_${dt}.txt | grep -v "TOTAL_POS:      0" | awk '{print $2,$(NF-6)}')|  mail -E -s "Unhedged Positions : $dt" uttkarsh.sarraf@tworoads.co.in ravi.parikh@tworoads.co.in nishit.bhandari@tworoads.co.in hardik.dhakate@tworoads-trading.co.in
