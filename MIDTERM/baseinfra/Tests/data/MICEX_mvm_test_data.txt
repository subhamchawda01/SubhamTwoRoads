# Tests for MICEX order feed, though it can be 
# used in any of the orderfeed as long as syntax is same


# SYNTAX <shc> <OnOrderAdd>    <buysell> <order_id> <price> <size> <is_slower> <intermediate>
# SYNTAX <shc> <OnOrderDelete> <buysell> <order_id> <is_slower> <intermediate>
# SYNTAX <shc> <OnOrderModify> <buysell> <order_id> <new_size> <is_slower> <intermediate>
# SYNTAX <shc> <OnOrderExec>   <aggressive_side> <order_id> <price> <size_exec> <is_slower> <intermediate> <exchange_timestamp>
# SYNTAX <shc> <OnMSRL1Update> <best_bid_price> <best_bid_size> <best_ask_price> <best_ask_size> <last_trade_price> <exchange_timestamp>
# SYNTAX TESTCASE <test_name> <to_reset_book>


#******************************TEST 1****************************************#

USD000TODTOM TESTCASE TestOrderADD 1
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681012   56.0000  10 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681013   56.0001  2  0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681014   55.9995  3  0 0
# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0001
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 2
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560001
# Level 2 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 10
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 2 560000
# Level 3 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 3 55.9995
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 3 3
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 3 559995





#******************************TEST 2****************************************#

USD000TODTOM TESTCASE TestOrderModify 1
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681012   56.0000 10 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681013   56.0001  2 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681014   55.9995  3 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681015   55.9992  5 0 0
USD000TODTOM 1490000000.000000 OnOrderModify B 124681012            8 0 0
USD000TODTOM 1490000000.000000 OnOrderModify B 124681014            6 0 0
# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0001
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 2
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560001
# Level 2 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 8
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 2 560000
# Level 3 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 3 55.9995
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 3 6
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 3 559995




#******************************TEST 3****************************************#
USD000TODTOM TESTCASE TestOrderDelete 1
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681012   56.0000 10 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681013   56.0001  2 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681014   55.9995  3 0 0
USD000TODTOM 1490000000.000000 OnOrderDelete B 124681012              0 0
# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0001
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 2
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560001
# Level 2 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 55.9995
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 3
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 2 559995




#******************************TEST 4****************************************#
USD000TODTOM TESTCASE TestOrderExecWithoutMSRUpdate 1
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681012  56.0000 80 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681013  56.0001 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681014  55.9995 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681016  55.9994 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681017  55.9993 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681018  55.9992 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    S 124681019  56.0005 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    S 124681020  56.0007 40 0 0

# Checking Level-1 after all the adds
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0001
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 40
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560001

# Orders clearing first Best Level and Second level Partially
USD000TODTOM 1490000000.000000 OnOrderExec   S 124681013  56.0001 40 0 0 1
USD000TODTOM 1490000000.000000 OnOrderExec   S 124681012  56.0000 40 0 0 2

# We just expect the best variables to get corrected 
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 40
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560000

# Sending Signal to adjust the book in accordance with the above trades
USD000TODTOM 1490000000.000000 OnOrderDelete B 124681013             0 0
USD000TODTOM 1490000000.000000 OnOrderModify B 124681012          40 0 0



# Checking for level-1 consistancy after the book is corrected
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 40
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560000


# Clearing the best level partially
USD000TODTOM 1490000000.000000 OnOrderExec   S 124681012  56.0000  10 0 0 3

# Checking for correct best variables though the book is not yet adjusted
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 30
#USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 55.9995
#USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 40


USD000TODTOM 1490000000.000000 OnOrderModify B 124681012           30 0 0

# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 30
# Level 2 checks
#USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 55.9995
#USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 40

USD000TODTOM 1490000000.000000 OnOrderModify B 124681012           20 0 0

# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
# Level 2 checks
#USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 55.9995
#USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 40


USD000TODTOM 1490000000.000000 OnOrderExec   S 124681012  56.0000  10 0 0 4

# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0000
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
# Level 2 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 55.9995
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 40

USD000TODTOM 1490000000.000000 OnOrderDelete B 124681012              0 0

# Level 1 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9995
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 40
# Level 2 checks
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 2 55.9994
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 2 40




#******************************TEST 5****************************************#
USD000TODTOM TESTCASE TestOrderExecWithMSRUpdate 1
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681012  56.0000 80 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681013  56.0001 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681014  55.9995 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681016  55.9994 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681017  55.9993 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681018  55.9992 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    B 124681015  55.9991 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    S 124681019  56.0005 40 0 0
USD000TODTOM 1490000000.000000 OnOrderAdd    S 124681020  56.0007 40 0 0

# Checking Level-1 after all the adds
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 56.0001
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 40
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 560001


# Sending the faster MSR L1 Update for Bid side
USD000TODTOM 1490000000.000000 OnMSRL1Update  			  55.9993 20 -1.0 -1 -1.0 1


# Checking Level-1 after MSR Update
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

# Aggressive Order clearing the levels
USD000TODTOM 1490000000.000000 OnOrderExec   S 124681013  56.0001 40 1 1 2

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderExec   S 124681012  56.0000 80 1 1 3

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderExec   S 124681014  55.9995 40 1 1 4

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993


USD000TODTOM 1490000000.000000 OnOrderExec   S 124681016  55.9994 40 1 1 5

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderExec   S 124681017  55.9993 20 1 0 6

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993


# Sending Order Modify/Delete accordingly for the above trade messages 

USD000TODTOM 1490000000.000000 OnOrderDelete B 124681013             1 1

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderDelete B 124681012             1 1

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderDelete B 124681014             1 1

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderDelete B 124681016             1 1

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993

USD000TODTOM 1490000000.000000 OnOrderModify B 124681012          20 1 1

# Checking Level-1 values
USD000TODTOM 1490000000.000000 DOUBLE_ASSERT PRICE B 1 55.9993
USD000TODTOM 1490000000.000000 INT_ASSERT    SIZE  B 1 20
USD000TODTOM 1490000000.000000 INT_ASSERT    INT_PRICE B 1 559993
